<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Utility · FeynmanDiagram.jl</title><meta name="title" content="Utility · FeynmanDiagram.jl"/><meta property="og:title" content="Utility · FeynmanDiagram.jl"/><meta property="twitter:title" content="Utility · FeynmanDiagram.jl"/><meta name="description" content="Documentation for FeynmanDiagram.jl."/><meta property="og:description" content="Documentation for FeynmanDiagram.jl."/><meta property="twitter:description" content="Documentation for FeynmanDiagram.jl."/><meta property="og:url" content="https://numericaleft.github.io/FeynmanDiagram.jl/lib/utility/"/><meta property="twitter:url" content="https://numericaleft.github.io/FeynmanDiagram.jl/lib/utility/"/><link rel="canonical" href="https://numericaleft.github.io/FeynmanDiagram.jl/lib/utility/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">FeynmanDiagram.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/counterterms/">Evaluation of counterterms</a></li><li><a class="tocitem" href="../../manual/feynman_rule/">Feynman Rules</a></li><li><a class="tocitem" href="../../manual/interaction/">Interaction/Scattering-Amplitude Convention</a></li><li><a class="tocitem" href="../../manual/hubbard_atom/">Hubbard Atom as a Test Case</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><a class="tocitem" href="../operator/">Quantum operator and its product</a></li><li><a class="tocitem" href="../computgraph/">Computational graph for general feynman diagrams</a></li><li><a class="tocitem" href="../taylorseries/">Taylor expansions in independent variables (support AbstractGraph)</a></li><li><a class="tocitem" href="../frontend/">Front-end generates Feynman diagrams and translates then into a computational graph</a></li><li><a class="tocitem" href="../GV/">GV expansion to a computational graph</a></li><li><a class="tocitem" href="../parquet/">Parquet Algorithm to Build Diagrams</a></li><li><a class="tocitem" href="../backend/">Compilers compile computational graphs to optimized source code for diverse platforms</a></li><li class="is-active"><a class="tocitem" href>Utility</a><ul class="internal"><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API reference</a></li><li class="is-active"><a href>Utility</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Utility</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/numericalEFT/FeynmanDiagram.jl/blob/master/docs/src/lib/utility.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Utility"><a class="docs-heading-anchor" href="#Utility">Utility</a><a id="Utility-1"></a><a class="docs-heading-anchor-permalink" href="#Utility" title="Permalink"></a></h1><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FeynmanDiagram.Utility.taylorAD-Union{Tuple{G}, Tuple{Vector{G}, Vector{Int64}, Vector{Function}}} where G&lt;:Graph" href="#FeynmanDiagram.Utility.taylorAD-Union{Tuple{G}, Tuple{Vector{G}, Vector{Int64}, Vector{Function}}} where G&lt;:Graph"><code>FeynmanDiagram.Utility.taylorAD</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function taylorAD(graphs::Vector{G}, deriv_orders::Vector{Int}, leaf_dep_funcs::Vector{Function};
    dict_graphs::Dict{Vector{Int},Vector{Graph}}=Dict{Vector{Int},Vector{Graph}}()
) where {G&lt;:Graph}

Performs Taylor-mode automatic differentiation (AD) on a vector of graphs, with the differentiation process tailored based on specified maximum orders of differentiation 
and leaf dependency functions. It categorizes the differentiated graphs in a dictionary based on their derivative orders.</code></pre><p><strong>Parameters</strong></p><ul><li><code>graphs</code>: A vector of graphs to be differentiated.</li><li><code>deriv_orders</code>: A vector of integers specifying the maximum orders of differentiation to apply to the graphs.</li><li><code>leaf_dep_funcs</code>: A vector of functions determining the dependency of differentiation variables on the properties of leaves in the graphs. </li><li><code>dict_graphs</code>: Optional. A dictionary for storing the output graphs, keyed by vectors of integers representing the specific differentiation orders. Defaults to an empty dictionary.</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{Vector{Int},Vector{Graph}}</code>: A dictionary containing the graphs processed through Taylor-mode AD, categorized by their differentiation orders.</li></ul><p><strong>Example Usage</strong></p><pre><code class="language-julia hljs"># Define a vector of graphs
graphs = [g1, g2]
# Specify the maximum orders of differentiation
deriv_orders = [2, 3, 3]

# Define a vector of differentiation dependency functions for the properties of leaf. 
# The first and second functions specify identify `BareGreenId` and `BareInteractionId` properties as the Green&#39;s function and interaction counterterms, respectively.
# The third function specifies the dependence of on the first external momentum of the leaf.
leaf_dep_funcs = [pr -&gt; pr isa FrontEnds.BareGreenId, pr -&gt; pr isa FrontEnds.BareInteractionId, pr -&gt; pr.extK[1] != 0]

# Perform Taylor-mode AD and categorize the results. `result_dict` holds the AD results, organized by differentiation orders `[0:2, 0:3, 0:3]`.
result_dict = taylorAD(graphs, deriv_orders, leaf_dep_funcs)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/FeynmanDiagram.jl/blob/165624ce4396aa44e5a98ef2878f36c3ff264808/src/utility.jl#L15-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FeynmanDiagram.Utility.taylorexpansion!-Union{Tuple{FeynmanGraph{F, W}}, Tuple{W}, Tuple{F}, Tuple{FeynmanGraph{F, W}, Dict{Int64, Vector{Bool}}}} where {F, W}" href="#FeynmanDiagram.Utility.taylorexpansion!-Union{Tuple{FeynmanGraph{F, W}}, Tuple{W}, Tuple{F}, Tuple{FeynmanGraph{F, W}, Dict{Int64, Vector{Bool}}}} where {F, W}"><code>FeynmanDiagram.Utility.taylorexpansion!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function taylorexpansion!(graph::FeynmanGraph{F,W}, var_dependence::Dict{Int,Vector{Bool}}=Dict{Int,Vector{Bool}}(); to_coeff_map::Dict{Int,TaylorSeries{G}}=Dict{Int,TaylorSeries{G}}()) where {F,W}

Return a taylor series of FeynmanGraph g, together with a map of between nodes of g and correponding taylor series.</code></pre><p><strong>Arguments:</strong></p><ul><li><code>graph</code>  Target FeynmanGraph </li><li><code>var_dependence::Dict{Int,Vector{Bool}}</code> A dictionary that specifies the variable dependence of target graph leaves. Should map the id of each leaf to a Bool vector.    The length of the vector should be the same as number of variables.</li><li><code>to_coeff_map::Dict{Int,TaylorSeries}</code> A dicitonary that maps id of each node of target graph to its correponding taylor series.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/FeynmanDiagram.jl/blob/165624ce4396aa44e5a98ef2878f36c3ff264808/src/utility.jl#L137-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FeynmanDiagram.Utility.taylorexpansion!-Union{Tuple{G}, Tuple{G, Dict{Int64, Vector{Bool}}}} where G&lt;:Graph" href="#FeynmanDiagram.Utility.taylorexpansion!-Union{Tuple{G}, Tuple{G, Dict{Int64, Vector{Bool}}}} where G&lt;:Graph"><code>FeynmanDiagram.Utility.taylorexpansion!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function taylorexpansion!(graph::G, var_dependence::Dict{Int,Vector{Bool}}=Dict{Int,Vector{Bool}}(); to_coeff_map::Dict{Int,TaylorSeries{G}}=Dict{Int,TaylorSeries{G}}()) where {G&lt;:Graph}

Return a taylor series of graph g, together with a map of between nodes of g and correponding taylor series.</code></pre><p><strong>Arguments:</strong></p><ul><li><code>graph</code>  Target graph </li><li><code>var_dependence::Dict{Int,Vector{Bool}}</code> A dictionary that specifies the variable dependence of target graph leaves. Should map the id of each leaf to a Bool vector.    The length of the vector should be the same as number of variables.</li><li><code>to_coeff_map::Dict{Int,TaylorSeries}</code> A dicitonary that maps id of each node of target graph to its correponding taylor series.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/FeynmanDiagram.jl/blob/165624ce4396aa44e5a98ef2878f36c3ff264808/src/utility.jl#L95-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FeynmanDiagram.Utility.taylorexpansion!-Union{Tuple{W}, Tuple{F}, Tuple{FeynmanGraph{F, W}, Tuple{Vector{Bool}, Vector{Bool}}}} where {F, W}" href="#FeynmanDiagram.Utility.taylorexpansion!-Union{Tuple{W}, Tuple{F}, Tuple{FeynmanGraph{F, W}, Tuple{Vector{Bool}, Vector{Bool}}}} where {F, W}"><code>FeynmanDiagram.Utility.taylorexpansion!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function taylorexpansion!(graph::FeynmanGraph{F,W}, propagator_var::Tuple{Vector{Bool},Vector{Bool}}, label::Tuple{LabelProduct,LabelProduct}; to_coeff_map::Dict{Int,TaylorSeries{Graph{F,W}}}=Dict{Int,TaylorSeries{Graph{F,W}}}()) where {F,W}

Return a taylor series of FeynmanGraph g, together with a map of between nodes of g and correponding taylor series. In this set up, the leaves that are the same type of propagators (fermi or bose) depend on the same set of variables, 
whereas other types of Feynman diagrams (such as vertices) depends on no variables that need to be differentiated (for AD purpose, they are just constants).</code></pre><p><strong>Arguments:</strong></p><ul><li><code>graph</code>  Target FeynmanGraph</li><li><code>propagator_var::Tuple{Vector{Bool},Vector{Bool}}</code> A Tuple that specifies the variable dependence of fermi (first element) and bose propagator (second element).   The dependence is given by a vector of the length same as the number of variables.</li><li><code>label::Tuple{LabelProduct,LabelProduct}</code> A Tuple fermi (first element) and bose LabelProduct (second element).</li><li><code>to_coeff_map::Dict{Int,TaylorSeries}</code> A dicitonary that maps id of each node of target diagram to its correponding taylor series.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/FeynmanDiagram.jl/blob/165624ce4396aa44e5a98ef2878f36c3ff264808/src/utility.jl#L175-L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FeynmanDiagram.Utility.taylorexpansion!-Union{Tuple{W}, Tuple{F}, Tuple{Graph{F, W}, Dict{DataType, Vector{Bool}}}} where {F, W}" href="#FeynmanDiagram.Utility.taylorexpansion!-Union{Tuple{W}, Tuple{F}, Tuple{Graph{F, W}, Dict{DataType, Vector{Bool}}}} where {F, W}"><code>FeynmanDiagram.Utility.taylorexpansion!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function taylorexpansion!(graph::Graph{F,W}, propagator_var::Dict{DataType,Vector{Bool}};
    to_coeff_map::Dict{Int,TaylorSeries{Graph{F,W}}}=Dict{Int,TaylorSeries{Graph{F,W}}}()) where {F,W}
    
Return a taylor series of Graph g, together with a map of between nodes of g and correponding taylor series. In this set up, the leaves that are the same type of diagrams (such as Green functions) depend on the same set of variables.</code></pre><p><strong>Arguments:</strong></p><ul><li><code>graph</code>  Target Graph</li><li><code>propagator_var::Dict{DataType,Vector{Bool}}</code> A dictionary that specifies the variable dependence of different types of diagrams. Should be a map between DataTypes in DiagramID and Bool vectors.   The dependence is given by a vector of the length same as the number of variables.</li><li><code>to_coeff_map::Dict{Int,TaylorSeries}</code> A dicitonary that maps id of each node of target diagram to its correponding taylor series.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/FeynmanDiagram.jl/blob/165624ce4396aa44e5a98ef2878f36c3ff264808/src/utility.jl#L205-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FeynmanDiagram.Utility.taylorexpansion_withmap-Tuple{G} where G&lt;:Graph" href="#FeynmanDiagram.Utility.taylorexpansion_withmap-Tuple{G} where G&lt;:Graph"><code>FeynmanDiagram.Utility.taylorexpansion_withmap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taylorexpansion_withmap(g::G; coeffmode=true, var::Vector{Int}=collect(1:get_numvars())) where {G&lt;:Graph}

Return a taylor series of graph g, together with a map of chain relationships between generated derivatives.
This function is only internally used for constructing high order derivatives by naive nested forward AD.
It is only for banch mark purpose and not exported.</code></pre><p><strong>Arguments:</strong></p><ul><li><code>g</code>  Target graph </li><li><code>coeffmode</code> If true, the generated taylor series saves taylor coefficients with the factorial prefactor. If false, the taylor series saves derivatives instead</li><li><code>var</code> The index of variables graph depends on</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/FeynmanDiagram.jl/blob/165624ce4396aa44e5a98ef2878f36c3ff264808/src/utility.jl#L257-L267">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../backend/">« Compilers compile computational graphs to optimized source code for diverse platforms</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 31 October 2024 13:20">Thursday 31 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
